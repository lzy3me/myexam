<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>MyExam</title>

    <!-- ====== Stylesheet ====== -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!-- ======= Script ======= -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/1ddae515d7.js"></script>

</head>
<style>
    .con-center {
        padding: 0 100px;
    }
    .con-inside {
        padding: 20px;
    }
    .con-bottom {
        padding-bottom: 50px;
    }
    .none-display {
        display: none;
    }
    .block-display {
        display: block;
    }
</style>
<body>
    <div class="container-fluid">
        
        <div class="con-center">
            
            <div class="card" id="note">
                <div class="card-header">
                    <h5>แบบทดสอบก่อนเรียน</h5>
                </div>
                <div class="con-inside">
                    <!-- Welcome Screen ask student to select subject before begin -->
                    <!-- Begin Subject Select -->
                    <div class="card-body block-display" id="welcome">
                        <h3 class="title text-center">
                            โปรดเลือกวิชาที่ต้องการทดสอบ
                        </h3>
                        <br>
                        <div class="form-group">
                            <label for="getclass">เลือกวิชา:</label>
                            <select class="form-control" id="getclass" name="sellist1">
                                <option value="none" disabled selected>--- เลือกวิชา ---</option>
                                <option value="1">คณิตศาสตร์</option>
                                <option value="1">เคมี</option>
                                <option value="1">วิทยาการคำนวณ</option>
                                <option value="1">ภาษาอังกฤษ</option>
                            </select>
                        </div>
                        <a href="javascript:;" class="btn btn-xl btn-block btn-success"
                        onclick="getQuestion()">
                            เริ่มทำแบบทดสอบ
                        </a>
                    </div>
                    <!-- End Subject Select -->

                    <div class="card-body none-display" id="test">
                        <h3 class="title text-center" id="title">
                            <span style="float: left">
                                <button class="btn btn-primary" data-toggle="tooltip" 
                                onclick="getBack()" title="กลับไปข้อก่อนหน้า">
                                    <i class="fas fa-arrow-left"></i>
                                </button>
                            </span>
                            Pretest - Myexam
                        </h3>
                        <br>
                        <!-- Topic -->
                        <p class="card-text" id="question" data-q=0>?</p>
                        <br>

                        <!-- Selector -->
                        <div class="row" id="quiz-section">
                            <div class="col-sm-6" style="padding: 4px;">
                                <button class="btn btn-dark btn-block" onclick="getAnswer('bt-1')" id="bt-1" data-select="1">1</button>
                            </div>
                            <div class="col-sm-6" style="padding: 4px;">
                                <button class="btn btn-dark btn-block" onclick="getAnswer('bt-2')" id="bt-2" data-select="2">2</button>
                            </div>
                            <div class="col-sm-6" style="padding: 4px;">
                                <button class="btn btn-dark btn-block" onclick="getAnswer('bt-3')" id="bt-3" data-select="3">3</button>
                            </div>
                            <div class="col-sm-6" style="padding: 4px;">
                                <button class="btn btn-dark btn-block" onclick="getAnswer('bt-4')" id="bt-4" data-select="4">4</button>
                            </div>
                        </div>
                        <!-- End Selecter -->
                        
                        <div class="con-bottom"></div>
                        <div class="progress">
                            <div class="progress-bar" style="width:10%"></div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>

    </div>
</body>
<script>
    var obj = '';
    var subject = '';
    var question = 0;
    var backBtn = '<span style="float: left"><button class="btn btn-primary" data-toggle="tooltip"'
                + ' onclick="getBack()" id="back" title="กลับไปข้อก่อนหน้า">'
                + ' <i class="fas fa-arrow-left"></i></button></span>';

    function getQuestion() {
        console.log('okay');
        var request = new XMLHttpRequest();
        request.open("GET", "quiz.json", false);
        request.send(null)
        obj = JSON.parse(request.responseText);
        
        subject = obj.module.subject;
        question = obj.module.question;

        initChange();
        getNextQuestion();
    }

    function initChange() {
        var w = document.getElementById('welcome');
        var t = document.getElementById('test');

        w.classList.remove('block-display');
        w.classList.add('none-display');

        t.classList.remove('none-display');
        t.classList.add('block-display');

        document.getElementById('title').innerHTML = backBtn + subject;
    }

    function getNextQuestion() {
        // Get Element For Question
        var i = 0;
        var q = document.getElementById('question');
        var e = document.getElementById('quiz-section');
        var qu = '';

        // Get data attribute for check total quest that answer
        var index = q.getAttribute('data-q');

        if (index <= question) {
            if (index > 0) {
                document.getElementById('back').disabled = '';
            } else {
                document.getElementById('back').disabled = true;
            }

            q.innerHTML = obj.quiz[index].title;
            for (i=0; i<obj.quiz[index].answer.length; i++) {
                qu += '<div class="col-sm-6" style="padding: 4px;"><button class="btn btn-dark btn-block"'
                    +' onclick="" id="bt-1" data-select="1">'+obj.quiz[index].answer[i]+'</button>'
                    +'</div>';
            }
            e.innerHTML = qu;
            index++
            q.setAttribute('data-q', index);
        }
        
    }
</script>
</html>